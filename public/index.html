<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ClimateJustice.news</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸŒ¿</text></svg>" />
  <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸŒ¿</text></svg>" />
  <meta name="description" content="Real-time climate justice news aggregator â€” search top stories by region, category, and date range." />
  <meta property="og:title" content="ClimateJustice.news" />
  <meta property="og:description" content="Real-time climate justice news aggregator â€” search top stories by region, category, and date range." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://climatejustice.news" />
  <meta property="og:image" content="https://climatejustice.news/og-img.png" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="ClimateJustice.news" />
  <meta name="twitter:description" content="Real-time climate justice news aggregator â€” search top stories by region, category, and date range." />
  <meta name="twitter:image" content="https://climatejustice.news/og-img.png" />
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-4WG9XES34T"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-4WG9XES34T');
  </script>
  <link rel="stylesheet" href="style.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link rel="dns-prefetch" href="//www.google.com" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
</head>
<body>

  <!-- Sticky stack: header + filter bar + controls bar in one fixed container -->
  <div id="sticky-stack">

  <!-- Header -->
  <header class="header">
    <div class="header-inner">
      <div class="header-brand">
        <span class="brand-icon">&#127807;</span>
        <div>
          <h1 class="brand-name">ClimateJustice<span class="brand-tld">.news</span></h1>
          <p class="brand-sub" id="brand-sub">Top stories Â· past 7 days</p>
        </div>
      </div>
      <div class="header-actions">
        <button id="info-btn" class="icon-btn" title="How this works">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="12" y1="8" x2="12" y2="12"></line>
            <line x1="12" y1="16" x2="12.01" y2="16"></line>
          </svg>
        </button>
        <button id="refresh-btn" class="icon-btn" title="Refresh feed (R)">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="23 4 23 10 17 10"></polyline>
            <polyline points="1 20 1 14 7 14"></polyline>
            <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
          </svg>
        </button>
        <button id="theme-btn" class="icon-btn" title="Toggle theme">
          <svg id="theme-icon-dark" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="5"></circle>
            <line x1="12" y1="1" x2="12" y2="3"></line>
            <line x1="12" y1="21" x2="12" y2="23"></line>
            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
            <line x1="1" y1="12" x2="3" y2="12"></line>
            <line x1="21" y1="12" x2="23" y2="12"></line>
            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
          </svg>
          <svg id="theme-icon-light" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display:none">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
          </svg>
        </button>
      </div>
    </div>
  </header>

  <!-- Filter bar -->
  <div class="filter-bar">
    <div class="filter-inner">
      <button class="filter-chip active" data-filter="All">All</button>
      <button class="filter-chip" data-filter="Environment">Environment</button>
      <button class="filter-chip" data-filter="Policy">Policy</button>
      <button class="filter-chip" data-filter="Community">Community</button>
      <button class="filter-chip" data-filter="Science">Science</button>
      <button class="filter-chip" data-filter="General">General</button>
    </div>
  </div>

  <!-- Controls bar: sort + date range + region focus -->
  <div class="controls-bar">
    <div class="controls-inner">
      <div class="control-group">
        <span class="control-label">Sort</span>
        <button class="ctrl-btn active" data-sort="popularity">Top</button>
        <button class="ctrl-btn" data-sort="publishedAt">Latest</button>
      </div>
      <div class="control-sep"></div>
      <div class="control-group">
        <span class="control-label">Range</span>
        <button class="ctrl-btn" data-days="1">24h</button>
        <button class="ctrl-btn" data-days="3">3d</button>
        <button class="ctrl-btn active" data-days="7">7d</button>
        <button class="ctrl-btn" data-days="30">30d</button>
      </div>
      <div class="control-sep"></div>
      <div class="control-group">
        <span class="control-label">Picks</span>
        <button id="picks-toggle-btn" class="ctrl-btn active" title="Editor's picks pinned to top â€” click to unpin">
          <svg width="10" height="10" viewBox="0 0 24 24" fill="currentColor" style="vertical-align:-1px"><path d="M16 3a1 1 0 0 1 .7 1.7l-1.4 1.4 1 3.6a1 1 0 0 1-.3 1l-3 2.6V17a1 1 0 0 1-.3.7l-2 2a1 1 0 0 1-1.5-1.3l.1-.1 1.7-1.7v-4.3a1 1 0 0 1 .3-.7l3-2.6-.9-3.3 1.5-1.5A1 1 0 0 1 16 3zm-5.7 11.6L4 21.3a1 1 0 0 0 1.3 1.5l.1-.1 6.3-6.3-1.4-.8z"/></svg>
          Pinned
        </button>
      </div>
    </div>
    <div class="controls-inner controls-inner--focus">
      <div class="control-group">
        <span class="control-label">Focus</span>
        <button class="ctrl-btn focus-btn active" data-region="global">ğŸŒ Global</button>
        <button class="ctrl-btn focus-btn" data-region="americas">ğŸŒ Americas</button>
        <button class="ctrl-btn focus-btn" data-region="africa">ğŸŒ Africa</button>
        <button class="ctrl-btn focus-btn" data-region="asia">ğŸŒ Asia Pacific</button>
        <button class="ctrl-btn focus-btn" data-region="europe">ğŸ‡ªğŸ‡º Europe</button>
        <button class="ctrl-btn focus-btn" data-region="mena">ğŸ•Œ MENA</button>
      </div>
    </div>
  </div>

  <!-- Editor banner â€” visible only when editor mode is active -->
  <div id="editor-banner" style="display:none" role="alert" aria-live="polite">
    <div class="editor-banner-inner">
      <span class="editor-badge">
        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M12 20h9"/><path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"/></svg>
        Editor Mode
      </span>
      <span id="editor-counts" class="editor-counts">Loadingâ€¦</span>
      <button id="editor-manage-btn" class="editor-banner-btn">Manage</button>
      <button id="editor-exit-btn" class="editor-banner-btn editor-banner-btn--exit">Exit</button>
    </div>
  </div>

  </div><!-- /sticky-stack -->

  <!-- Main content -->
  <main class="main">
    <div class="feed" id="feed">
      <!-- Skeleton loaders -->
      <div class="skeleton-card"><div class="sk sk-header"></div><div class="sk sk-title"></div><div class="sk sk-title short"></div><div class="sk sk-img"></div><div class="sk sk-text"></div><div class="sk sk-text short"></div><div class="sk sk-footer"></div></div>
      <div class="skeleton-card"><div class="sk sk-header"></div><div class="sk sk-title"></div><div class="sk sk-title short"></div><div class="sk sk-img"></div><div class="sk sk-text"></div><div class="sk sk-text short"></div><div class="sk sk-footer"></div></div>
      <div class="skeleton-card"><div class="sk sk-header"></div><div class="sk sk-title"></div><div class="sk sk-img"></div><div class="sk sk-text"></div><div class="sk sk-footer"></div></div>
    </div>

    <!-- Error state (hidden by default) -->
    <div class="error-state" id="error-state" style="display:none">
      <div class="error-icon">&#9888;&#65039;</div>
      <h2 class="error-title">Couldn't load the feed</h2>
      <p class="error-msg" id="error-msg">Something went wrong.</p>
      <button class="retry-btn" id="retry-btn">Try again</button>
    </div>

    <!-- Empty state (hidden by default) -->
    <div class="error-state" id="empty-state" style="display:none">
      <div class="error-icon">&#127803;</div>
      <h2 class="error-title">No articles found</h2>
      <p class="error-msg">No climate justice articles were found for this filter. Try another category or refresh.</p>
      <button class="retry-btn" id="clear-filter-btn">Clear filter</button>
    </div>
  </main>

  <!-- Toast -->
  <div class="toast" id="toast"></div>

  <!-- Footer -->
  <footer class="footer">
    <span>Powered by <a href="https://newsapi.org" target="_blank" rel="noopener">NewsAPI</a></span>
    <span class="footer-sep">Â·</span>
    <span id="article-count"></span>
    <span class="footer-sep">Â·</span>
    <span>Press <kbd>R</kbd> to refresh</span>
    <span class="footer-sep">Â·</span>
    <a href="https://github.com/pjuxio/Climate-Justice-Feed" target="_blank" rel="noopener">GitHub</a>
    <span class="footer-sep">Â·</span>
    <a href="https://buymeacoffee.com/pjux" target="_blank" rel="noopener" class="bmc-link">â˜• Buy me a coffee</a>
  </footer>

  <!-- Info modal -->
  <div class="modal-overlay" id="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="modal-title" style="display:none">
    <div class="modal">
      <div class="modal-header">
        <h2 class="modal-title" id="modal-title">How this feed works</h2>
        <button class="modal-close" id="modal-close" aria-label="Close">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
      </div>
      <div class="modal-body">

        <section class="info-section">
          <h3 class="info-heading">What is this?</h3>
          <p><strong>ClimateJustice.news</strong> aggregates real-time English-language news articles related to climate justice from thousands of global sources, powered by <a href="https://newsapi.org" target="_blank" rel="noopener">NewsAPI</a>. Results are refreshed on demand and cached for 5 minutes to keep things fast.</p>
        </section>

        <section class="info-section">
          <h3 class="info-heading">Keyword search approach</h3>
          <p>Every search uses a base query that covers key terms in the climate justice space:</p>
          <ul class="info-list">
            <li><code>"climate justice"</code></li>
            <li><code>"environmental justice"</code></li>
            <li><code>"climate equity"</code></li>
            <li><code>"climate racism"</code></li>
            <li><code>"just transition"</code></li>
            <li><code>"climate policy"</code></li>
            <li><code>"fossil fuels"</code></li>
            <li><code>"environmental law"</code></li>
            <li><code>"carbon tax"</code></li>
            <li><code>"COP30"</code></li>
            <li><code>"climate summit"</code></li>
          </ul>
          <p>These are combined with <strong>OR</strong> so any article matching at least one phrase is included. This casts a wide net while staying focused on justice-framing â€” not just climate science or policy in general.</p>
        </section>

        <section class="info-section">
          <h3 class="info-heading">Regional focus</h3>
          <p>Selecting a region <strong>narrows</strong> results by ANDing the base query with geographic terms specific to that region. For example, choosing <strong>Africa</strong> appends:</p>
          <p class="info-code">AND (Africa OR Nigeria OR Kenya OR Ghana OR "South Africa" OR Ethiopia OR "Sub-Saharan" â€¦)</p>
          <p>This surfaces stories where both the justice framing <em>and</em> the region appear, rather than just filtering by publisher location.</p>
        </section>

        <section class="info-section">
          <h3 class="info-heading">Categories</h3>
          <p>Each article is auto-categorised on the server by scanning its headline and description for keyword patterns:</p>
          <ul class="info-list">
            <li><strong>Policy</strong> â€” legislation, government, regulation, COP summits</li>
            <li><strong>Community</strong> â€” grassroots, activism, Indigenous, protest, movement</li>
            <li><strong>Science</strong> â€” research, data, emissions, temperature reports</li>
            <li><strong>Environment</strong> â€” ecosystems, biodiversity, oceans, forests</li>
            <li><strong>General</strong> â€” everything else</li>
          </ul>
        </section>

        <section class="info-section">
          <h3 class="info-heading">Sort &amp; range</h3>
          <p><strong>Top</strong> ranks by article popularity across NewsAPI's index. <strong>Latest</strong> ranks by publish date. The date range controls how far back the search window reaches â€” from the past 24 hours up to 30 days.</p>
        </section>

      </div>
    </div>
  </div>

  <!-- Editor login modal -->
  <div class="modal-overlay" id="editor-login-overlay" role="dialog" aria-modal="true" aria-labelledby="editor-login-title" style="display:none">
    <div class="modal editor-login-modal">
      <div class="modal-header">
        <h2 class="modal-title" id="editor-login-title">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="vertical-align:-2px;margin-right:6px"><path d="M12 20h9"/><path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"/></svg>
          Editor Login
        </h2>
        <button class="modal-close" id="editor-login-close" aria-label="Close">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
      </div>
      <div class="modal-body" style="gap:14px">
        <p style="font-size:0.875rem;color:var(--text-secondary);line-height:1.55">Enter your editor token to enable curation controls. Your token is stored for this session only.</p>
        <input type="password" id="editor-token-input" class="editor-token-input" placeholder="Editor token" autocomplete="current-password" />
        <p id="editor-login-error" class="editor-login-error" style="display:none"></p>
        <button id="editor-login-submit" class="retry-btn" style="align-self:flex-start">Enter Editor Mode</button>
      </div>
    </div>
  </div>

  <!-- Editor manage modal â€” shows pinned & hidden articles -->
  <div class="modal-overlay" id="editor-manage-overlay" role="dialog" aria-modal="true" aria-labelledby="editor-manage-title" style="display:none">
    <div class="modal">
      <div class="modal-header">
        <h2 class="modal-title" id="editor-manage-title">Manage Curation</h2>
        <button class="modal-close" id="editor-manage-close" aria-label="Close">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
      </div>
      <div class="modal-body" id="editor-manage-body" style="gap:20px">
        <!-- Populated by JS -->
      </div>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
